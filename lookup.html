<!DOCTYPE html>

<html lang="en">
    <head>
        <title>Find A Recipe</title>
        <meta charset="UTF-8">
        <script src="./node_modules/jquery/dist/jquery.min.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.22.1/firebase-app.js"></script>

        <script src="https://www.gstatic.com/firebasejs/7.22.1/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.22.1/firebase-database.js"></script>

        <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
        <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>

        <script src="./viewrecipe.js"></script>
        <script src="./AutoCompleteSuggestion.js"></script>
        <script src="./findrecipe.js"></script>
        <script src="./newrecipe.js"></script>
        <script src="./settings.js"></script>
        <script src="./grocerylistdisplay.js"></script>
        <script src="./grocerylist.js"></script>
        <!-- script src="./listfood.js"></script -->

        <link type="text/css" rel="stylesheet" href="./style/stylesheet.css" />
        <script>
            var firebaseConfig = {
                apiKey: "AIzaSyCPpZJJ5xm8wevrmdy9zB7k_dc_8wyXww0",
                authDomain: "authtest-af1e0.firebaseapp.com",
                databaseURL: "https://authtest-af1e0.firebaseio.com",
                projectId: "authtest-af1e0",
                storageBucket: "authtest-af1e0.appspot.com",
                messagingSenderId: "483513788016",
                appId: "1:483513788016:web:cf2898648d3b9c15bcb6b5",
                measurementId: "G-936C46KKLS"
            };
            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);
            var database = firebase.database();
        </script>
    </head>
    <body>
        <div id="wrapper">
            <div id="menucontainer">
                <div id="leftmenuicons">
                    <span id="viewfindrecipe" class="clickable slow">&nbsp;&larr;</span>
                </div>
                <div id="menuicons">
                    <span id="newrecipe" class="clickable slow">+&nbsp;</span>
                    <span id="viewprofile" class="clickable slow">&cirmid;&nbsp;</span>
                    <span id="viewsettings" class="clickable slow">&curren;&nbsp;</span>
                </div>
            </div>
            <h1><br/></h1>
            <div id="search-container"></div>
            <div id="componentbox"></div>
        </div>
        <script>

            function hideAllContainers()
            {
                $("#componentbox").css("display", "none");
                $("#search-container").css("display", "none");
            }

            $("#componentbox").css("display", "none");

            // Show grocery list when user is logged in
            firebase.auth().onAuthStateChanged(function(user) {
                if (user)
                {
                    // Grab a reference to the user's list in the database
                    let userRef = firebase.database().ref(`profiles/${user.uid}`);
                    let recipeRef = firebase.database().ref('recipes');

                    // Is the menu bar active?
                    let sideMenuBarActive = false;

                    // Render a view of a single recipe
                    function viewRecipe(_user, key)
                    {
                        renderRecipeView(_user, key, viewRecipeFinder, "Return to Find Recipes", document.getElementById("componentbox"), false, userRef, recipeRef);

                        // Display proper content
                        $("#search-container").css("display", "none");
                        $("#componentbox").css("display", "block");
                        $("#viewfindrecipe").css("display", "inline");
                    }

                    function viewRecipeFinder()
                    {
                        renderRecipeFinder(viewRecipe, recipeRef, userRef, document.getElementById("search-container"));
                        $("#componentbox").css("display", "none");
                        $("#search-container").css("display", "block");
                        $("#viewfindrecipe").css("display", "none");
                    }

                    function viewNewRecipeForm()
                    {
                        $("#search-container").css("display", "none");
                        $("#componentbox").css("display", "block");
                        renderNewRecipeForm(user, recipeRef, viewRecipeFinder, document.getElementById("componentbox"));
                        $("#viewfindrecipe").css("display", "inline");
                    }

                    function viewGroceryList()
                    {
                        $("#search-container").css("display", "none");
                        $("#componentbox").css("display", "block");
                        renderList(userRef, recipeRef, document.getElementById("componentbox"));
                        $("#viewfindrecipe").css("display", "inline");
                    }

                    function viewSettings()
                    {
                        $("#search-container").css("display", "none");
                        $("#componentbox").css("display", "block");
                        renderSettingsView(userRef, document.getElementById("componentbox"));
                        $("#viewfindrecipe").css("display", "inline");
                    }

                    $("#newrecipe").on("click", function(event) {
                        viewNewRecipeForm();
                    });

                    $("#viewprofile").on("click", function(event) {
                        viewGroceryList();
                    });

                    $("#viewsettings").on("click", function(event) {
                        viewSettings();
                    });

                    $("#viewfindrecipe").on("click", function(event)
                    {
                        viewRecipeFinder();
                    });

                    viewRecipeFinder();
                }
                else
                {
                }
            });
        </script>
    </body>
</html>
