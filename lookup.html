<!DOCTYPE html>

<html lang="en">
    <head>
        <title>Find A Recipe</title>
        <meta charset="UTF-8">
        <script src="https://kit.fontawesome.com/ca7e1b4280.js" crossorigin="anonymous"></script>
        <script src="./node_modules/jquery/dist/jquery.min.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.22.1/firebase-app.js"></script>

        <script src="https://www.gstatic.com/firebasejs/7.22.1/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.22.1/firebase-database.js"></script>

        <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
        <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>

        <script src="./viewrecipe.js"></script>
        <script src="./AutoCompleteSuggestion.js"></script>
        <script src="./findrecipe.js"></script>
        <script src="./newrecipe.js"></script>
        <script src="./settings.js"></script>
        <script src="./grocerylistdisplay.js"></script>
        <script src="./grocerylist.js"></script>
        <script src="./pantry.js"></script>

        <!-- link type="text/css" rel="stylesheet" href="./style/stylesheet.css" / -->
        <link type="text/css" rel="stylesheet" href="./style/neustyle.css" />
        <script>
            var firebaseConfig = {
                apiKey: "AIzaSyCPpZJJ5xm8wevrmdy9zB7k_dc_8wyXww0",
                authDomain: "authtest-af1e0.firebaseapp.com",
                databaseURL: "https://authtest-af1e0.firebaseio.com",
                projectId: "authtest-af1e0",
                storageBucket: "authtest-af1e0.appspot.com",
                messagingSenderId: "483513788016",
                appId: "1:483513788016:web:cf2898648d3b9c15bcb6b5",
                measurementId: "G-936C46KKLS"
            };
            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);
            var database = firebase.database();
        </script>
    </head>
    <body>
        <div id="wrapper">
            <div id="menucontainer">
                <div class='left-menu-icons'>
                    <!--
                    <span id="viewfindrecipe" class="clickable slow">&larr;Back</span>
                    -->
                    <span id="viewfindrecipe" class="clickable light-button-circle"><i class="fas fa-angle-double-left"></i></span>
                </div>
                <div class='right-menu-icons'>
                    <!--
                    <span id="newrecipe" class="clickable slow">New +</span>
                    <span id="viewprofile" class="clickable slow">List &cirmid;</span>
                    <span id="viewsettings" class="clickable slow">Settings &curren;</span>
                    -->
                    <span id="newrecipe" class="clickable light-button-circle"><i class="fas fa-plus"></i></span>
                    <span id="viewprofile" class="clickable light-button-circle"><i class="fas fa-list"></i></span>
                    <span id="viewsettings" class="clickable light-button-circle"><i class="fas fa-cog"></i></span>
                </div>
            </div>
            <h1><br/></h1>
            <div id="search-container"></div>
            <div id="componentbox" class="primary-content-card"></div>
            <div id="additional-components"></div>
            <table id="image-container" class="top-image-container">
                <tr>
                    <td class="editor-pick card">
                        <img src="./images/tiramisu.jpg"/>
                        <h2 class="clickable">
                            Tiramisu by Devin
                        </h2>
                    </td>

                    <td class="editor-pick card">
                        <img id="img2" src="./images/poutine.jpg"/>
                        <h2 class="clickable">
                            Poutine by Devin
                        </h2>
                    </td>

                    <td class="editor-pick card">
                        <img src="./images/tiramisu.jpg"/>
                    </td>
                </tr>
            </table>
        </div>
        <script>

            $("#componentbox").css("display", "none");

            $("#img1").css("height", $("#img1").css("width"));
            $("#img2").css("height", $("#img2").css("width"));
            $("#img3").css("height", $("#img3").css("width"));

            function hideAllContainers()
            {
                $("#componentbox").css("display", "none");
                $("#search-container").css("display", "none");
                $("#additional-components").css("display", "none");
            }

            function resetAllMenuButtons()
            {
                $(".dark-button-circle").addClass("light-button-circle");
                $(".light-button-circle").removeClass("dark-button-circle");
            }

            // Show grocery list when user is logged in
            firebase.auth().onAuthStateChanged(function(user) {
                if (user)
                {
                    // Grab a reference to the user's list in the database
                    let userRef = firebase.database().ref(`profiles/${user.uid}`);
                    let recipeRef = firebase.database().ref('recipes');

                    // Is the menu bar active?
                    let sideMenuBarActive = false;

                    // Render a view of a single recipe
                    function viewRecipe(_user, key)
                    {
                        renderRecipeView(_user, key, viewRecipeFinder, "Return to Find Recipes", document.getElementById("componentbox"), false, userRef, recipeRef);

                        // Display proper content
                        $("#search-container").css("display", "none");
                        $("#componentbox").css("display", "block");
                        $("#viewfindrecipe").css("display", "inline-block");

                        $("#image-container").css("display", "none");
                        $("#additional-components").css("display", "none");

                        resetAllMenuButtons();
                    }

                    function viewRecipeFinder()
                    {
                        renderRecipeFinder(viewRecipe, recipeRef, userRef, document.getElementById("search-container"));
                        $("#componentbox").css("display", "none");
                        $("#search-container").css("display", "block");
                        $("#viewfindrecipe").css("display", "none");

                        $("#additional-components").css("display", "none");

                        $("#image-container").css("display", "table");

                        resetAllMenuButtons();
                    }

                    function viewNewRecipeForm()
                    {
                        $("#search-container").css("display", "none");
                        $("#componentbox").css("display", "block");
                        renderNewRecipeForm(user, recipeRef, viewRecipeFinder, document.getElementById("componentbox"));
                        $("#viewfindrecipe").css("display", "inline-block");

                        $("#additional-components").css("display", "none");

                        $("#image-container").css("display", "none");

                        resetAllMenuButtons();
                        $("#newrecipe").addClass("dark-button-circle");
                        $("#newrecipe").removeClass("light-button-circle");
                    }

                    function viewGroceryList()
                    {
                        $("#search-container").css("display", "none");
                        $("#componentbox").css("display", "block");
                        renderList(userRef, recipeRef, document.getElementById("componentbox"));
                        $("#viewfindrecipe").css("display", "inline-block");

                        $("#additional-components").css("display", "none");

                        $("#image-container").css("display", "none");

                        resetAllMenuButtons();
                        $("#viewprofile").addClass("dark-button-circle");
                        $("#viewprofile").removeClass("light-button-circle");
                    }

                    function viewSettings()
                    {
                        $("#search-container").css("display", "none");
                        $("#componentbox").css("display", "block");
                        $("#additional-components").css("display", "block");

                        renderSettingsView(userRef, document.getElementById("componentbox"));

                        const pantryContainerHTML = "<div id='pantry-container' class='primary-content-card'></div>";
                        $("#additional-components").html(pantryContainerHTML);
                        renderPantry(userRef, document.getElementById("pantry-container"));

                        $("#viewfindrecipe").css("display", "inline-block");

                        $("#image-container").css("display", "none");

                        resetAllMenuButtons();
                        $("#viewsettings").addClass("dark-button-circle");
                        $("#viewsettings").removeClass("light-button-circle");
                    }

                    $("#newrecipe").on("click", function(event) {
                        viewNewRecipeForm();
                    });

                    $("#viewprofile").on("click", function(event) {
                        viewGroceryList();
                    });

                    $("#viewsettings").on("click", function(event) {
                        viewSettings();
                    });

                    $("#viewfindrecipe").on("click", function(event)
                    {
                        viewRecipeFinder();
                    });

                    viewRecipeFinder();
                }
                else
                {
                }
            });
        </script>
    </body>
</html>
