<html>
  <head>
    <title>Redirected</title>
    <script src="./node_modules/jquery/dist/jquery.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.22.1/firebase-app.js"></script>

     <script src="https://www.gstatic.com/firebasejs/7.22.1/firebase-auth.js"></script>
     <script src="https://www.gstatic.com/firebasejs/7.22.1/firebase-database.js"></script>
     <link type="text/css" rel="stylesheet" href="./style/stylesheet.css" />
    <script>
      var firebaseConfig = {
        apiKey: "AIzaSyCPpZJJ5xm8wevrmdy9zB7k_dc_8wyXww0",
        authDomain: "authtest-af1e0.firebaseapp.com",
        databaseURL: "https://authtest-af1e0.firebaseio.com",
        projectId: "authtest-af1e0",
        storageBucket: "authtest-af1e0.appspot.com",
        messagingSenderId: "483513788016",
        appId: "1:483513788016:web:cf2898648d3b9c15bcb6b5",
        measurementId: "G-936C46KKLS"
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      var database = firebase.database();
    </script>
  </head>
  <body>
    <div id="intro">
      <h1>Welcome to the login page</h1>
      <p id="display">Content</p>
    </div>
    <div id="grocerylist"></div>
    <script>
      // Render food items in the box
      function renderList(groceries)
      {
        let html = "";
        // Loop through all food items in list
        for (const item in groceries)
        {
          html += "<div>";
          html += `<h2>${item}</h2>`;
          html += "<ul>";
          // Loop through all ingredients in each food
          for (const ingredient in groceries[item])
          {
            html += `<li>${ingredient} ${groceries[item][ingredient]}</li>`;
          }
          html += "</ul></div>";
        }
        $("#grocerylist").html(html);
      }

      // Show grocery list when user is logged in
      firebase.auth().onAuthStateChanged(function(user) {
      if (user) {
        $("#display").html(`${user.displayName}'s Grocery List`);
        var listRef = firebase.database().ref(`lists/${user.uid}`);
        listRef.on('value', function(snapshot) {
          renderList(snapshot.val());
        });
      } else {
        $("#display").html("No User");
      }
    });
    </script>
  </body>
</html>
